## TextRank 文档压缩思路

TextRank 是一种基于图的排序算法，受 **PageRank** 启发，常用于文本摘要、关键词提取等任务。在文档压缩的应用中，TextRank 利用图结构计算词语的相对重要性，并根据重要性提取与查询相关的文档部分。

### 1. 简介

TextRank 基于图的思想，通过构建词汇之间的共现关系图（或块之间的共现关系图），利用 PageRank 算法计算每个节点（即词汇或文档块）的权重，从而判断其在文档中的重要性。最终通过选择重要性较高的部分进行文档压缩。

### 2. 带 QUERY 的 TextRank 文档压缩

当有查询（**QUERY**）时，文档压缩的目标是提取与查询相关性高的文档块。TextRank 在此过程中会先构建文档块中的关键词图，利用 PageRank 算法计算节点的权重，最后根据查询选择最相关的块。

#### 步骤

1. **对 QUERY 进行分词**  
   使用分词工具（如 Jieba）对查询进行分词，得到查询中的关键词列表。

2. **对文档进行分块**  
   将文档分为多个块，例如按段落、句子或固定字数分块，并为每个分块分配唯一的序号。

3. **对每个分块进行分词**  
   对每个文档块单独进行分词，得到块内的词汇列表。

4. **构建关键词图（基于共现关系）**  
   在每个分块中，识别出关键词并创建节点。基于词语之间的共现关系，构建图中的边，边的权重反映了词语之间的语义或共现紧密度。

   - **节点**：每个词汇作为图中的节点。
   - **边**：基于共现关系或语义相似性构建边，通常使用文本相似度（如 Jaccard 相似度、余弦相似度）来衡量权重。

5. **使用 PageRank 算法计算节点权重**  
   使用 PageRank 算法对关键词图进行迭代计算，获得每个节点的权重。PageRank 会根据词语之间的共现情况调整每个词汇的重要性，较为频繁且重要的词语会得到更高的权重。

6. **提取全局关键词**  
   综合文档整体的 PageRank 分布，选择那些权重较高的关键词，这些关键词代表了文档中最重要的信息。

7. **选择与 QUERY 相关的分块**  
   比较文档分块中的关键词和查询关键词之间的相关性（通常使用余弦相似度、Jaccard 相似度等）。选择与查询最相关的 TOP-N 个分块。

8. **压缩文档并按序号排序输出**  
   根据选择的分块及其顺序输出压缩后的文档，保留与查询相关的重要内容。

#### 优势

- **基于共现关系**：TextRank 可以通过词汇间的共现关系来捕捉词汇的语义相似性，避免了简单的词频统计问题。
- **无需监督**：TextRank 不依赖于外部标签或标注数据，可以用于无监督的文档压缩和关键词提取。
- **考虑全局语境**：通过 PageRank 算法，TextRank 能够综合考虑文档中各个词的全局重要性，而不仅仅依赖于局部词频。

### 3. 不带 QUERY 的 TextRank 文档压缩

在没有查询（**QUERY**）的情况下，TextRank 将根据文档本身的结构和内容来进行压缩，自动选择出最具代表性的文档部分。

#### 步骤

1. **对文档进行分块**  
   将文档分为多个块（例如按段落、句子或固定字数分块）。

2. **对每个分块进行分词**  
   对每个文档块单独进行分词，得到块内的词汇列表。

3. **构建关键词图**  
   在每个文档块中识别出关键词，并构建一个基于共现关系的图（节点表示词汇，边表示词汇之间的共现或语义相似度）。

4. **使用 PageRank 计算节点权重**  
   计算文档中每个词的 PageRank 权重，得到词汇在文档中的相对重要性。

5. **提取全局关键词**  
   通过计算文档整体的 PageRank 分布，提取出全局最重要的关键词，反映文档的核心主题。

6. **选择 TOP-N 分块**  
   根据每个文档块中的关键词与文档全局关键词的相关性，选择与文档主题最契合的 TOP-N 个分块。这可以通过计算每个分块的关键词与全局关键词之间的相似度来完成。

7. **压缩文档并排序输出**  
   根据选择的分块，输出压缩后的文档，保留最具代表性的部分。

#### 优势

- **自动提取文档核心内容**：不依赖于外部查询，能够自动识别文档中最具信息量的部分。
- **基于图模型**：通过共现图和 PageRank 算法，能够有效捕捉文档中的语义关系，避免了传统方法的局限性。
- **全局优化**：TextRank 能够在整个文档范围内优化关键词的选择，确保文档压缩后仍能保留关键信息。

### 4. 对比

| 方案                      | 带 **QUERY** 的压缩                          | 不带 **QUERY** 的压缩                   |
|-------------------------|-----------------------------------------|---------------------------------------|
| **输入**                | 包含查询（QUERY）                        | 仅包含文档文本                        |
| **目标**                | 提取与查询相关的文档部分                    | 提取文档中的关键信息块                  |
| **关键步骤**            | 计算分块中与查询相关的关键词，基于 PageRank 排序选择分块 | 计算每个分块的关键词与文档整体关键词的相似性，选择最具信息量的分块 |
| **输出**                | 按照查询选择 TOP N 分块，排序输出              | 按照全局关键词选择 TOP N 分块，排序输出 |
| **优点**                 | 精准匹配查询需求，压缩文档保留查询相关部分         | 自动提取文档最有信息量的部分，无需外部输入      |

### 5. 总结

- **带 QUERY 的 TextRank 文档压缩** 通过查询关键词引导文档压缩过程，能够高效保留与查询相关的关键信息，适合查询驱动的文档压缩任务。
- **不带 QUERY 的 TextRank 文档压缩** 通过文档内容本身的共现关系和 PageRank 算法，自动提取出最具代表性的文档部分，适用于文档摘要和信息提取任务。